{% load roles %}
{% load cart_tags %}
{% get_cart_count as cart_count %}

{% if user.is_authenticated %}
  {% if user.is_staff or user.is_superuser or user|has_group:'admin' %}
    <a href="{% url 'dashboardadmin' %}" class="nav-link-custom"><i class="bi bi-speedometer2"></i><span class="nav-text">Dashboard</span></a>
    <a href="{% url 'order_list' %}" class="nav-link-custom">
      <i class="bi bi-list-check"></i><span class="nav-text">Pedidos</span>
      <span class="badge bg-danger rounded-pill ms-1" id="worker-orders-badge" {% if pending_orders_count == 0 %}style="display: none;"{% endif %}>{{ pending_orders_count }}</span>
    </a>
    <a href="{% url 'stock' %}" class="nav-link-custom"><i class="bi bi-box-seam"></i><span class="nav-text">Stock</span></a>
    <a href="{% url 'marketing_dashboard' %}" class="nav-link-custom"><i class="bi bi-tags"></i><span class="nav-text">Marketing</span></a>
    <a href="{% url 'logout' %}" class="nav-link-custom"><i class="bi bi-box-arrow-right"></i><span class="nav-text">Salir</span></a>
  {% elif user|has_group:'trabajador' %}
    <a href="{% url 'dashboardtrabajador' %}" class="nav-link-custom"><i class="bi bi-speedometer2"></i><span class="nav-text">Dashboard</span></a>
    <a href="{% url 'order_list' %}" class="nav-link-custom" id="worker-orders-link">
      <i class="bi bi-list-check"></i><span class="nav-text">Pedidos</span>
      <span class="badge bg-danger rounded-pill ms-1" id="worker-orders-badge" {% if pending_orders_count == 0 %}style="display: none;"{% endif %}>{{ pending_orders_count }}</span>
    </a>
    <a href="{% url 'stock' %}" class="nav-link-custom"><i class="bi bi-box-seam"></i><span class="nav-text">Stock</span></a>
    <a href="{% url 'barcode_tool' %}" class="nav-link-custom"><i class="bi bi-upc-scan"></i><span class="nav-text">Códigos</span></a>
    <a href="{% url 'pos' %}" class="nav-link-custom"><i class="bi bi-cash"></i><span class="nav-text">Caja</span></a>
    <a href="{% url 'logout' %}" class="nav-link-custom"><i class="bi bi-box-arrow-right"></i><span class="nav-text">Salir</span></a>
  {% else %}
    <a href="{% url 'rewards_catalog' %}" class="nav-link-custom"><i class="bi bi-star-fill"></i><span class="nav-text">Mis Puntos</span></a>
    <a href="{% url 'profile' %}" class="nav-link-custom"><i class="bi bi-person-circle"></i><span class="nav-text">Mi Perfil</span></a>
    <a href="{% url 'cart_view' %}" class="nav-link-custom" aria-label="Carrito">
      <i class="bi bi-cart"></i><span class="nav-text">Carrito</span>
      {% if cart_count > 0 %}
        <span class="badge bg-danger rounded-pill ms-2">
          {% if cart_count > 9 %}9+{% else %}{{ cart_count }}{% endif %}
        </span>
      {% endif %}
    </a>
    <a href="{% url 'logout' %}" class="nav-link-custom"><i class="bi bi-box-arrow-right"></i><span class="nav-text">Salir</span></a>
  {% endif %}
{% else %}
  <a href="{% url 'login' %}" class="nav-link-custom"><i class="bi bi-person"></i><span class="nav-text">Iniciar Sesión</span></a>
  <a href="{% url 'register' %}" class="nav-link-custom"><i class="bi bi-person-plus"></i><span class="nav-text">Registrarse</span></a>
  <a href="{% url 'cart_view' %}" class="nav-link-custom" aria-label="Carrito">
    <i class="bi bi-cart"></i><span class="nav-text">Carrito</span>
    {% if cart_count > 0 %}
      <span class="badge bg-danger rounded-pill ms-2">
        {% if cart_count > 9 %}9+{% else %}{{ cart_count }}{% endif %}
      </span>
    {% endif %}
  </a>
{% endif %}
